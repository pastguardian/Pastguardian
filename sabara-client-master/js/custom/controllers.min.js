"use strict";function MainCtrl($scope,$http,$cookies,$location,loader){$scope.user={};$scope.setUser=function(d){for(var i in d){$scope.user[i]=d[i];$cookies[i]=d[i]}};$scope.checkUser=function(){if(!angular.isUndefined($cookies.id)){for(var i in $cookies){$scope.user[i]=$cookies[i]}return true}else return false};$scope.disconnect=function(){$scope.user=$scope.petugas={};if($scope.showSitemap)$scope.showSitemap=false;for(var i in $cookies)delete $cookies[i];$location.path("/login").replace()};$scope.showSitemap=false;$scope.toggleSitemap=function(){$scope.showSitemap=!$scope.showSitemap};$scope.getPath=function(){var c=$location.path().substring(1)||"home";if(c.indexOf("/")!=-1)return c.split("/")[0];return c};$scope.menuShow=function(arr,id){id=parseInt(id);return jQuery.inArray(id,arr)!=-1};$scope.getSubMenu=function(){var l=$location.path().split("/");return l[l.length-1]};$scope.needUnit=function(){return angular.isUndefined($scope.user.id_unit)};$scope.myUnit=function(){return typeof $scope.user.id_unit=="undefined"?0:$scope.user.id_unit};$scope.passtoedit={};$scope.resetPassToEdit=function(){$scope.passtoedit={pass1:"",pass2:""}};$scope.resetPassToEdit()}MainCtrl.$inject=["$scope","$http","$cookies","$location"];function LoginCtrl($scope,$location,$http,loader){if($scope.checkUser()){$location.path("/home").replace()}$scope.ping=function(){loader.show();$http({url:$scope.server+"/ping?version="+$scope.versi+"&subversion="+$scope.subversi,method:"GET"}).success(function(d){if(d.status=="PASSED")loader.hide();else{loader.hide();$("#old-version").fadeIn()}}).error(function(e,s,h){alertify.log("Tidak dapat terhubung dengan server. Pastikan Anda terhubung dengan internet","error",0)})};$scope.ping();$scope.userform={username:"",password:""}}LoginCtrl.$inject=["$scope","$location","$http","loader"];function HomeCtrl($scope,$location,$http,$routeParams,$cookies){if(!$scope.checkUser())$scope.disconnect();$scope.submenu=new Number($routeParams.menuId)||0}HomeCtrl.$inject=["$scope","$location","$http","$routeParams","$cookies"];"use strict";function DataCtrl($scope,$http,$cookies,$location,loader){if(!$scope.checkUser())$scope.disconnect();$http.defaults.headers.common["Authorization"]="Basic "+Base64.encode($cookies.username+":"+$cookies.password);$scope.curMenu=0;$scope.submenu=$scope.getSubMenu();$scope.getParentTitle=function(){return $scope.menu[$scope.curMenu].title};$scope.getItemTitle=function(i){return $scope.menu[$scope.curMenu].item[i].title};$scope.getUnit=function(){return angular.isUndefined($scope.user.nama_unit)?"":$scope.user.nama_unit};$scope.range=function(start,end){var r=[];if(!end){end=start;start=0}for(var i=start;i<end;i++)r.push(i);return r};$scope.blth=[];$scope.getblth=function(){$http({url:$scope.server+"/blth",method:"GET"}).success(function(d){for(var i in d){if(d[i].status=="1"){$scope.ekspor.blth=d[i].id;break}}$scope.blth=d})};$scope.file=null;if($scope.submenu=="unit"){$scope.unitList=[];$scope.unit={};$scope.resetUnit=function(){$scope.unit={id:0,kode:"",nama:""}};$scope.resetUnit();$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unitList=d}).error(function(e,s,h){if(s.status==401){$scope.$apply(function(){$scope.disconnect()})}})};$scope.loadUnit();$scope.setUnit=function(i){$scope.unit=$scope.unitList[i]}}if($scope.submenu=="gardu"){$scope.unit=[];$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.getcurUnit=function(){for(var i=0;i<$scope.unit.length;i++){if($scope.unit[i].id==$scope.gardu.unit)return $scope.unit[i].nama}};$scope.loadUnit();$scope.gardu={};$scope.egardu={};$scope.garduList=[];$scope.presetGardu=function(){$scope.gardu={unit:$scope.myUnit(),cpage:0,numpage:0}};$scope.presetGardu();$scope.loadGardu=function(){loader.show();if($scope.gardu.unit==0)return alertify.error("Anda belum memilih unit");$http({url:$scope.server+"/gardu?"+jQuery.param($scope.gardu),method:"GET"}).success(function(d){$scope.garduList=d.data;$scope.gardu.numpage=d.numpage;loader.hide()}).error(function(e,s,h){loader.hide()})};if(!$scope.needUnit())$scope.loadGardu();$scope.setGardu=function(i){$scope.egardu=$scope.garduList[i];$scope.editing=true};$scope.resetGardu=function(){$scope.egardu={id:0,unit:$scope.gardu.unit,nama:""};$scope.editing=false};$scope.resetGardu();$scope.setPage=function(){$scope.gardu.cpage=this.n;$scope.loadGardu()};$scope.prevPage=function(){if($scope.gardu.cpage>0)$scope.gardu.cpage--;$scope.loadGardu()};$scope.nextPage=function(){if($scope.gardu.cpage<$scope.gardu.numpage-1)$scope.gardu.cpage++;$scope.loadGardu()};$scope.editing=false;$scope.koordinat={};$scope.resetKoordinat=function(){$scope.koordinat={data:[],center:[]}};$scope.resetKoordinat();$scope.setKoordinat=function(d){$scope.koordinat=d}}if($scope.submenu=="rbm"){$scope.rbm={};$scope.erbm={};$scope.rbmList=[];$scope.unit=[];$scope.resetRbm=function(){$scope.rbm={unit:$scope.myUnit(),keyword:"",cpage:0,numpage:0}};$scope.resetRbm2=function(){$scope.erbm={id:"",nama:"",petugas:"",unit:""}};$scope.resetRbm2();$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.getcurUnit=function(){for(var i=0;i<$scope.unit.length;i++){if($scope.unit[i].id==$scope.rbm.unit)return $scope.unit[i].nama}};$scope.petugasList=[];$scope.loadPetugas=function(){$http({url:$scope.server+"/petugas/unit/"+$scope.rbm.unit,method:"GET"}).success(function(d){$scope.petugasList=d})};$scope.editing=false;$scope.row=0;$scope.setPetugas=function(i){if($scope.editing){$scope.editing=false;$scope.row=0}else{$scope.editing=true;$scope.row=i}};$scope.updatePetugas=function(i){loader.show();$http({url:$scope.server+"/rbm",method:"POST",data:$scope.rbmList[i]}).success(function(d){$scope.rbmList[i]=d;loader.hide();$scope.editing=false;$scope.row=0}).error(function(e,s,h){loader.hide()});$scope.$apply()};$scope.loadRbm=function(){if($scope.rbm.unit=="0")return alertify.error("Anda belum memilih unit");loader.show();$http({url:$scope.server+"/rbm?"+jQuery.param($scope.rbm),method:"GET"}).success(function(d){if(d.numpage==0)alertify.error("Tidak ada data yang ditampilkan");loader.hide();$scope.rbmList=d.data;$scope.rbm.numpage=d.numpage;$scope.loadPetugas()}).error(function(e,s,h){loader.hide()})};$scope.loadUnit();$scope.resetRbm();if(!$scope.needUnit())$scope.loadRbm();$scope.setPrevious=function(){var p=$scope.rbm.cpage-1;if(p<0)return;$scope.rbm.cpage--;$scope.loadRbm()};$scope.setNext=function(){var n=$scope.rbm.cpage+1;if(n>$scope.rbm.numpage-1)return;$scope.rbm.cpage++;$scope.loadRbm()};$scope.koordinat={};$scope.resetKoordinat=function(){$scope.koordinat={data:[],center:[]}};$scope.resetKoordinat();$scope.setKoordinat=function(d){$scope.koordinat=d}}$scope.impor={tipe:"1"};if($scope.submenu=="impor"){$scope.result={unit:"",tipe:"",blth:"",jumlah:0,file:""};$scope.setResult=function(d){$scope.result=d};$scope.progress=0;$scope.setProgress=function(d){$scope.progress=d}}$scope.kdproses=[];$scope.ekspor={unit:$scope.myUnit(),blth:"",tgl:(new Date).toString("dd/MM/yyyy"),kode:0};$scope.loadKdProses=function(){$http({url:$scope.server+"/kodeproses",method:"GET"}).success(function(d){$scope.kdproses.push({id:0,kode:"",nama:"-- kode proses --"});for(var i in d)$scope.kdproses.push(d[i])})};if($scope.submenu=="ekspor"){$scope.getblth();$scope.loadKdProses();$scope.unit=[];$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.loadUnit()}}DataCtrl.$inject=["$scope","$http","$cookies","$location","loader"];"use strict";function CetakCtrl($scope,$http,$cookies,$location,loader){if(!$scope.checkUser())$scope.disconnect();$http.defaults.headers.common["Authorization"]="Basic "+Base64.encode($cookies.username+":"+$cookies.password);$scope.curMenu=3;$scope.submenu=$scope.getSubMenu();$scope.getParentTitle=function(){return $scope.menu[$scope.curMenu].title};$scope.getItemTitle=function(i){return $scope.menu[$scope.curMenu].item[i].title};$scope.unit=[];$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.loadUnit();$scope.blth=[];$scope.getblth=function(){$http({url:$scope.server+"/blth",method:"GET"}).success(function(d){for(var i in d){if(d[i].status=="1"){$scope.dpm.blth=$scope.lbkb.blth=$scope.unread.blth=d[i].id;break}}$scope.blth=d})};$scope.getblth();$scope.dpm={};if($scope.submenu=="dpm"){$scope.resetDpm=function(){$scope.dpm={unit:$scope.myUnit(),rbm:"",blth:""}};$scope.resetDpm();$scope.rbmList=[];$scope.loadRBM=function(){$scope.dpm.rbm="";$http({url:$scope.server+"/rbm/unit/"+$scope.dpm.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.dpmList=[];$scope.loadDPM=function(){if($scope.dpm.rbm=="")return alertify.error("Anda belum memilih RBM");loader.show();$http({url:$scope.server+"/listdpm?"+jQuery.param($scope.dpm),method:"GET"}).success(function(d){loader.hide();$scope.dpmList=d}).error(function(e,s,h){loader.hide()})};$scope.getParam=function(){return jQuery.param($scope.dpm)}}$scope.lbkb={};if($scope.submenu=="lbkb"){$scope.resetLbkb=function(){$scope.lbkb={unit:$scope.myUnit(),rbm:"",blth:"",lbkb:""}};$scope.resetLbkb();$scope.rbmList=[];$scope.loadRBM=function(){$scope.lbkb.rbm="";$http({url:$scope.server+"/rbm/unit/"+$scope.lbkb.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.lbkblist=[];$scope.getLbkb=function(){$http({url:$scope.server+"/lbkb",method:"GET"}).success(function(d){$scope.lbkblist.push({id:"",kode:"",nama:"-- pilih lbkb --"});for(var i in d)$scope.lbkblist.push(d[i])})};$scope.getLbkb();$scope.lbkbData=[];$scope.loadLBKBData=function(){$http({url:$scope.server+"/lbkb",method:"GET"}).success(function(d){$scope.lbkbData=d})};$scope.loadLBKBData();$scope.lbkbList=[];$scope.loadLBKB=function(){if($scope.lbkb.rbm=="")return alertify.error("Anda belum memilih RBM");loader.show();$http({url:$scope.server+"/listlbkb?"+jQuery.param($scope.lbkb),method:"GET"}).success(function(d){if(d.length==0)alertify.error("Tidak ada data");loader.hide();$scope.lbkbList=d}).error(function(e,s,h){loader.hide()})};$scope.getParam=function(){return jQuery.param($scope.lbkb)}}$scope.ba={};if($scope.submenu=="ba"){$scope.resetBa=function(){$scope.ba={idpel:""}};$scope.resetBa()}$scope.unread={};if($scope.submenu=="unread"){$scope.resetUnread=function(){$scope.unread={unit:$scope.myUnit(),rbm:""}};$scope.resetUnread();$scope.rbmList=[];$scope.loadRBM=function(){$scope.unread.rbm="";$http({url:$scope.server+"/rbm/unit/"+$scope.unread.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.uList=[];$scope.loadUnread=function(){if($scope.unread.rbm=="")return alertify.error("Anda belum memilih RBM");loader.show();$http({url:$scope.server+"/listunread?"+jQuery.param($scope.unread),method:"GET"}).success(function(d){if(d.length==0)alertify.error("Tidak ada data");loader.hide();$scope.uList=d}).error(function(e,s,h){loader.hide()})};$scope.getParam=function(){return jQuery.param($scope.unread)}}$scope.range=function(start,end){var r=[];if(!end){end=start;start=0}for(var i=start;i<end;i++)r.push(i);return r};$scope.stmt={unit:$scope.myUnit(),cpage:0,numpage:0};if($scope.submenu=="kirim"){$scope.stmtList=[];$scope.loadSTMT=function(){if($scope.stmt.unit==0)return alertify.error("Anda belum memilih unit");loader.show();$http({url:$scope.server+"/liststmt?"+jQuery.param($scope.stmt),method:"GET"}).success(function(d){loader.hide();if(d.data.length==0)alertify.error("Tidak ada data");$scope.stmtList=d.data;$scope.stmt.numpage=d.numpage}).error(function(e,s,h){loader.hide()})};if(!$scope.needUnit())$scope.loadSTMT();$scope.setPage=function(){$scope.stmt.cpage=this.n;$scope.loadSTMT()};$scope.prevPage=function(){if($scope.stmt.cpage>0)$scope.stmt.cpage--;$scope.loadSTMT()};$scope.nextPage=function(){if($scope.stmt.cpage<$scope.stmt.numpage-1)$scope.stmt.cpage++;$scope.loadSTMT()}}$scope.npde={unit:$scope.myUnit(),cpage:0,numpage:0};if($scope.submenu=="terima"){$scope.npdeList=[];$scope.loadNPDE=function(){if($scope.npde.unit==0)return alertify.error("Anda belum memilih unit");loader.show();$http({url:$scope.server+"/listnpde?"+jQuery.param($scope.npde),method:"GET"}).success(function(d){loader.hide();if(d.data.length==0)alertify.error("Tidak ada data");$scope.npdeList=d.data;$scope.npde.numpage=d.numpage}).error(function(e,s,h){loader.hide()})};if(!$scope.needUnit())$scope.loadNPDE();$scope.setPage=function(){$scope.npde.cpage=this.n;$scope.loadNPDE()};$scope.prevPage=function(){if($scope.npde.cpage>0)$scope.npde.cpage--;$scope.loadNPDE()};$scope.nextPage=function(){if($scope.npde.cpage<$scope.npde.numpage-1)$scope.npde.cpage++;$scope.loadNPDE()}}if($scope.submenu=="badayabesar"){$scope.idpel=""}}MainCtrl.$inject=["$scope","$http","$cookies","$location","loader"];"use strict";function MeterCtrl($scope,$http,$cookies,$location,loader){if(!$scope.checkUser())$scope.disconnect();$http.defaults.headers.common["Authorization"]="Basic "+Base64.encode($cookies.username+":"+$cookies.password);$scope.curMenu=2;$scope.submenu=$scope.getSubMenu();$scope.getParentTitle=function(){return $scope.menu[$scope.curMenu].title};$scope.getItemTitle=function(i){return $scope.menu[$scope.curMenu].item[i].title};$scope.file=null;$scope.blth=[];$scope.getblth=function(){$http({url:$scope.server+"/blth",method:"GET"}).success(function(d){$scope.blth=d})};$scope.getblth();$scope.setBlth=function(d){$scope.blth=d};if($scope.submenu=="blth"){$scope.bt={};$scope.resetBt=function(){$scope.bt={id:0,nama:"",status:1}};$scope.resetBt();$scope.editBlth=function(i){var s=$scope.blth[i];$scope.bt={id:s.id,nama:s.nama,status:s.status}}}$scope.unit=[];$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.entry={};$scope.koreksi={};if($scope.submenu=="entry"){$scope.rbmList=[];$scope.loadUnit();$scope.resetEntry=function(){$scope.entry={unit:$scope.myUnit(),rbm:"",idpel:"",nometer:""}};$scope.resetEntry();$scope.isGanda=function(tarif,daya){if(tarif.length==0)return;var d=parseInt(daya),t=tarif.toLowerCase();return d>2e5||t=="i2"};$scope.loadRBM=function(){$http({url:$scope.server+"/rbm/unit/"+$scope.entry.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.ketbaca=[];$scope.loadKetBaca=function(){$http({url:$scope.server+"/ketbaca",method:"GET"}).success(function(d){$scope.ketbaca=d})};$scope.loadKetBaca();$scope.pelangganList=[];$scope.setPelangganList=function(d){$scope.pelangganList=d};$scope.resetPelangganList=function(){$scope.pelangganList=[]};$scope.pelanggan={};$scope.resetPelanggan=function(){$scope.pelanggan={idpel:"",nama:"",tarif:"",daya:"",alamat:"",latitude:"",longitude:"",lwbp0:"",lwbp:"",plwbp:"",wbp0:"",wbp:"",pwbp:"",kvarh0:"",kvarh:"",pkvarh:"",ketbaca:""}};$scope.resetPelanggan();$scope.setPelanggan=function(d){$scope.pelanggan=d};$scope.resetKoreksi=function(){$scope.koreksi={idpel:"",nometer:""}};$scope.resetKoreksi();$scope.plggn={};$scope.resetPlggn=function(){$scope.plggn={idpel:"",nama:"",tarif:"",daya:"",alamat:"",latitude:"",longitude:"",lwbp0:"",lwbp:"",plwbp:"",wbp0:"",wbp:"",pwbp:"",kvarh0:"",kvarh:"",pkvarh:"",ketbaca:"",foto:""}};$scope.resetPlggn();$scope.setPlggn=function(d){$scope.plggn=d}}$scope.hp={};if($scope.submenu=="impor"){$scope.rbmList=[];$scope.loadUnit();$scope.resetHp=function(){$scope.hp={unit:$scope.myUnit(),rbm:"",tgl:(new Date).toString("dd/MM/yyyy")};$scope.baca={total:0,data:[],tidaknormal:0}};$scope.resetHp();$scope.loadRBM=function(){$scope.hp.rbm="";$http({url:$scope.server+"/rbm/unit/"+$scope.hp.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.baca={};$scope.setUpload=function(){$scope.upload=!$scope.upload};$scope.report={total:0,normal:0,keterangan:0};$scope.setReport=function(d){$scope.report=d};$scope.loadBaca=function(){if($scope.hp.rbm=="")return alertify.error("Anda belum mengisi RBM");loader.show();$http({url:$scope.server+"/bacarbm/"+$scope.hp.rbm+"/"+$scope.hp.tgl.replace(/\//g,""),method:"GET"}).success(function(d){$scope.baca=d;loader.hide();if(d.data.length==0)alertify.error("Tidak ada data untuk tanggal ini")})}}if($scope.submenu=="foto"){$scope.numfiles="";$scope.setNumFiles=function(d){$scope.numfiles=d}}}DataCtrl.$inject=["$scope","$http","$cookies","$location","loader"];"use strict";function AnalisaCtrl($scope,$http,$cookies,$location,loader){if(!$scope.checkUser())$scope.disconnect();$http.defaults.headers.common["Authorization"]="Basic "+Base64.encode($cookies.username+":"+$cookies.password);$scope.curMenu=4;$scope.submenu=$scope.getSubMenu();$scope.getParentTitle=function(){return $scope.menu[$scope.curMenu].title};$scope.getItemTitle=function(i){return $scope.menu[$scope.curMenu].item[i].title};$scope.unit=[];$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.loadUnit();$scope.blth=[];$scope.getblth=function(){$http({url:$scope.server+"/blth",method:"GET"}).success(function(d){for(var i in d){if(d[i].status=="1"){$scope.adlpd.blth=$scope.catat.blth1=$scope.catat.blth2=d[i].id;break}}$scope.blth=d})};$scope.getblth();$scope.adlpd={};if($scope.submenu=="dlpd"){$scope.checked=[];$scope.dlpd=[];$scope.getDlpd=function(){$http({url:$scope.server+"/dlpd/filter",method:"GET"}).success(function(d){for(var i=0;i<d.length;i++)$scope.checked[i]=false;$scope.dlpd=d})};$scope.getDlpd();$scope.resetAdlpd=function(){$scope.adlpd={unit:$scope.myUnit(),blth:"",rbm:""}};$scope.resetAdlpd();$scope.rbmList=[];$scope.loadRBM=function(){$http({url:$scope.server+"/rbm/unit/"+$scope.adlpd.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.getChecked=function(){var ids=[];for(var i=0;i<$scope.checked.length;i++){if($scope.checked[i]){ids.push($scope.dlpd[i].id)}}return ids};$scope.getParam=function(){return jQuery.param({unit:$scope.adlpd.unit,blth:$scope.adlpd.blth,dlpd:$scope.getChecked()})};$scope.dlpdList=[];$scope.loadDLPD=function(){if($scope.adlpd.unit==0)return alertify.error("Anda belum memilih unit");var checked=$scope.getChecked();if(checked.length==0)return alertify.error("Anda belum memilih DLPD");loader.show();var get={unit:$scope.adlpd.unit,blth:$scope.adlpd.blth,rbm:$scope.adlpd.rbm,dlpd:checked};$http({url:$scope.server+"/listdlpd?"+jQuery.param(get),method:"GET"}).success(function(d){loader.hide();$scope.dlpdList=d;if(d.length==0)alertify.error("Tidak ada data yang ditampilkan")}).error(function(e,s,h){loader.hide()})}}$scope.catat={};if($scope.submenu=="lbkb"){$scope.resetCatat=function(){$scope.catat={unit:$scope.myUnit(),blth1:"",blth2:""}};$scope.resetCatat();$scope.rekap={data:[],total:0};$scope.loadRekap=function(){if($scope.catat.unit==0)return alertify.error("Anda belum memilih unit");loader.show();$http({url:$scope.server+"/listrekaplbkb?"+jQuery.param($scope.catat),method:"GET"}).success(function(d){loader.hide();$scope.rekap=d;$scope.setLoadGraph(1)}).error(function(e,s,h){loader.hide()})};$scope.loadGraph=0;$scope.setLoadGraph=function(d){$scope.loadGraph=d};$scope.getParam=function(){return jQuery.param($scope.catat)}}}AnalisaCtrl.$inject=["$scope","$http","$cookies","$location","loader"];"use strict";function PelangganCtrl($scope,$http,$cookies,$location,loader,$routeParams){if(!$scope.checkUser())$scope.disconnect();$http.defaults.headers.common["Authorization"]="Basic "+Base64.encode($cookies.username+":"+$cookies.password);$scope.curMenu=1;$scope.submenu=$scope.getSubMenu();$scope.getParentTitle=function(){return $scope.menu[$scope.curMenu].title};$scope.getItemTitle=function(i){return $scope.menu[$scope.curMenu].item[i].title};$scope.file=null;$scope.unit=[];$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.loadUnit();if($scope.submenu=="data"){$scope.datapel={};$scope.resetDataPel=function(d){$scope.datapel={unit:$scope.myUnit(),idpel:"",nometer:""}};$scope.datapelanggan=[];$scope.setDataPel=function(d){$scope.datapel=d};$scope.loadPelanggan=function(){if($scope.datapel.unit==0)return alertify.error("Anda belum memilih Unit");if($scope.datapel.idpel==""&&$scope.datapel.nometer=="")return alertify.error("Anda harus mengisi salah satu input");loader.show();$http({url:$scope.server+"/listpelanggan?"+jQuery.param($scope.datapel),method:"GET"}).success(function(d){loader.hide();if(d.length==0){alertify.error("Tidak ada data yang ditampilkan");$scope.datapelanggan=d}else{$scope.datapelanggan=d}}).error(function(e,s,h){loader.hide()})};if(angular.isUndefined($scope.datapel.unit))$scope.resetDataPel()}if($scope.submenu=="detail"){$scope.detail={};$scope.historyList=[];$scope.history={};$scope.resetHistory=function(){$scope.history={id:$routeParams.Idpel,cpage:0,numpage:0}};$scope.resetHistory();$scope.showHistory=false;$scope.toggleHistory=function(){$scope.showHistory=!$scope.showHistory};$scope.loadHistory=function(){loader.show();$http({url:$scope.server+"/history?"+jQuery.param($scope.history),method:"GET"}).success(function(d){loader.hide();$scope.historyList=d.data;$scope.history.numpage=d.numpage}).error(function(e,s,h){loader.hide()})};$scope.loadHistory();$scope.loadDetail=function(){$http({url:$scope.server+"/pelanggan/detail/"+$routeParams.Idpel,method:"GET"}).success(function(d){$scope.detail=d})};$scope.loadDetail();$scope.getId=function(){return $routeParams.Idpel};$scope.range=function(start,end){var r=[];if(!end){end=start;start=0}for(var i=start;i<end;i++)r.push(i);return r};$scope.setPage=function(){$scope.history.cpage=this.n;$scope.loadHistory()};$scope.prevPage=function(){if($scope.history.cpage>0)$scope.history.cpage--;$scope.loadHistory()};$scope.nextPage=function(){if($scope.history.cpage<$scope.history.numpage-1)$scope.history.cpage++;$scope.loadHistory()}}if($scope.submenu=="npp"){$scope.npp={jenis:""};$scope.result={file:"",numdata:0}}if($scope.submenu=="tunggak"){$scope.tunggak={unit:$scope.myUnit(),keyword:"",cpage:0};$scope.numpage=0;$scope.rbmList=[];$scope.loadRbm=function(){loader.show();$http({method:"GET",url:$scope.server+"/tunggakan?"+jQuery.param($scope.tunggak)}).success(function(d){loader.hide();$scope.rbmList=d.data;$scope.numpage=d.numpage})};$scope.setPrevious=function(){var p=$scope.tunggak.cpage-1;if(p<0)return;$scope.tunggak.cpage--;$scope.loadRbm()};$scope.setNext=function(){var n=$scope.tunggak.cpage+1;if(n>$scope.tunggak.numpage-1)return;$scope.tunggak.cpage++;$scope.loadRbm()};$scope.showMap=true;$scope.showDetail=false;$scope.showMapContainer=function(){$scope.showDetail=false;$scope.showMap=true};$scope.listDetail=[];$scope.currentRbm="";$scope.loadDetail=function(nama){$scope.currentRbm=nama;loader.show();$scope.showDetail=false;$http({method:"GET",url:$scope.server+"/tunggakan/detail/"+nama}).success(function(d){loader.hide();if(d.length==0)return alertify.error("Tidak ada data di RBM");$scope.listDetail=d;$scope.showDetail=true;$scope.showMap=false})};$scope.koordinat={};$scope.resetKoordinat=function(){$scope.koordinat={data:[],center:[]}};$scope.resetKoordinat();$scope.setKoordinat=function(d){$scope.koordinat=d};$scope.setCetakLunas=function(i,t){loader.show();$http({url:$scope.server+"/tusbung/"+(t==1?"cetak":"lunas")+"/"+$scope.listDetail[i].id,method:"GET"}).success(function(d){loader.hide();if(d.status==1){$scope.listDetail[i].status=1;alertify.success("Data berhasil diubah")}if(t==2)$scope.loadDetail($scope.currentRbm)})}}if($scope.submenu=="monitoring"){$scope.rbmList=[];$scope.hp={unit:$scope.myUnit(),rbm:"",tgl:(new Date).toString("dd/MM/yyyy")};$scope.loadRBM=function(){$scope.hp.rbm="";$http({url:$scope.server+"/rbm/unit/"+$scope.hp.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.tusbung=[];$scope.loadTusbung=function(){loader.show();$http({url:$scope.server+"/tusbung?"+jQuery.param($scope.hp),method:"GET"}).success(function(d){loader.hide();$scope.tusbung=d})}}if($scope.submenu=="laporan"){$scope.rbmList=[];$scope.report={unit:$scope.myUnit(),rbm:"",blth:""};$scope.loadRBM=function(){$scope.report.rbm="";$http({url:$scope.server+"/rbm/unit/"+$scope.report.unit,method:"GET"}).success(function(d){$scope.rbmList=d})};if($scope.myUnit()!=0)$scope.loadRBM();$scope.blth=[];$scope.getblth=function(){$http({url:$scope.server+"/blth",method:"GET"}).success(function(d){for(var i in d){if(d[i].status=="1")$scope.report.blth=d[i].id;break}$scope.blth=d})};$scope.getblth()}}PelangganCtrl.$inject=["$scope","$http","$cookies","$location","loader","$routeParams"];"use strict";function MapCtrl($scope,$http,$cookies,$location,loader,$routeParams){if(!$scope.checkUser())$scope.disconnect();$http.defaults.headers.common["Authorization"]="Basic "+Base64.encode($cookies.username+":"+$cookies.password);$scope.type="";$scope.param="";$scope.getMapType=function(){var path=$location.path().split("/");$scope.type=path[2];$scope.param=path[3]};$scope.getMapType()}"use strict";function UserCtrl($scope,$http,$cookies,$location,loader){if(!$scope.checkUser())$scope.disconnect();$http.defaults.headers.common["Authorization"]="Basic "+Base64.encode($cookies.username+":"+$cookies.password);$scope.curMenu=5;$scope.submenu=$scope.getSubMenu();$scope.getParentTitle=function(){return $scope.menu[$scope.curMenu].title};$scope.getItemTitle=function(i){return $scope.menu[$scope.curMenu].item[i].title};$scope.unit=[];$scope.loadUnit=function(){$http({url:$scope.server+"/unit",method:"GET"}).success(function(d){$scope.unit.push({id:0,kode:"",nama:"-- pilih unit --"});for(var i in d){$scope.unit.push(d[i])}})};$scope.range=function(start,end){var r=[];if(!end){end=start;start=0}for(var i=start;i<end;i++)r.push(i);return r};if($scope.submenu=="petugas"||$scope.submenu=="koordinator"){$scope.crpetugas={};$scope.loadUnit();$scope.modePetugas="show";$scope.crpetugas={nama:"",unit:$scope.myUnit(),cpage:0,numpage:0};$scope.petugasList=[];$scope.petugas={};$scope.resetPetugas=function(){$scope.modePetugas="show";$scope.petugas={id:0,nama:"",id_unit:0,username:"",password:"",password2:""}};$scope.resetPetugas();$scope.setPetugas=function(i,t){$scope.modePetugas=t;$scope.petugas=$scope.petugasList[i]};$scope.searchPetugas=function(){$scope.crpetugas.cpage=0;$scope.loadPetugas()};$scope.loadPetugas=function(){loader.show();$http({url:$scope.server+"/"+$scope.submenu+"?"+jQuery.param($scope.crpetugas),method:"GET"}).success(function(d){$scope.petugasList=d.user;$scope.crpetugas.numpage=d.numpage;loader.hide()}).error(function(e,s,h){loader.hide()})};$scope.setPage=function(){$scope.crpetugas.cpage=this.n;$scope.loadPetugas()};$scope.prevPage=function(){if($scope.crpetugas.cpage>0)$scope.crpetugas.cpage--;$scope.loadPetugas()};$scope.nextPage=function(){if($scope.crpetugas.cpage<$scope.crpetugas.numpage-1)$scope.crpetugas.cpage++;$scope.loadPetugas()}}if($scope.submenu=="administrator"||$scope.submenu=="observer"){$scope.modeAdmin="show";$scope.adminList=[];$scope.admin={};$scope.resetAdmin=function(){$scope.modeAdmin="show";$scope.admin={id:0,username:"",password:"",password2:""}};$scope.resetAdmin();$scope.setAdmin=function(i,t){$scope.modeAdmin=t;$scope.admin=$scope.adminList[i]};$scope.loadAdmin=function(){loader.show();$http({url:$scope.server+"/"+$scope.submenu,method:"GET"}).success(function(d){$scope.adminList=d;loader.hide()}).error(function(e,s,h){loader.hide()})};$scope.loadAdmin()}}UserCtrl.$inject=["$scope","$http","$cookies","$location","loader"];